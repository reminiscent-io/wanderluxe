| schemaname | tablename           | policyname                                                      | cmd    | roles           | permissive | qual                                                                                                                                                                                                                                                                                                                                                                                                               | with_check                                                                                                                                                                                                                                                                               |
| ---------- | ------------------- | --------------------------------------------------------------- | ------ | --------------- | ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| cron       | job                 | cron_job_policy                                                 | ALL    | {public}        | PERMISSIVE | (username = CURRENT_USER)                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                                                     |
| cron       | job_run_details     | cron_job_run_details_policy                                     | ALL    | {public}        | PERMISSIVE | (username = CURRENT_USER)                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                                                     |
| public     | accommodations      | Users can delete accommodations with edit permission            | DELETE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | accommodations      | Users can delete their accommodations                           | DELETE | {authenticated} | PERMISSIVE | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                     |
| public     | accommodations      | Users can delete their own accommodations                       | DELETE | {public}        | PERMISSIVE | (auth.uid() IN ( SELECT trips.user_id
   FROM trips
  WHERE (trips.trip_id = accommodations.trip_id)))                                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                     |
| public     | accommodations      | Users can insert accommodations with edit permission            | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                        |
| public     | accommodations      | Users can insert their accommodations                           | INSERT | {authenticated} | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                  |
| public     | accommodations      | Users can insert their own accommodations                       | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (auth.uid() IN ( SELECT trips.user_id
   FROM trips
  WHERE (trips.trip_id = accommodations.trip_id)))                                                                                                                                                                                   |
| public     | accommodations      | Users can update accommodations with edit permission            | UPDATE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | accommodations      | Users can update their accommodations                           | UPDATE | {authenticated} | PERMISSIVE | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                            | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                  |
| public     | accommodations      | Users can update their own accommodations                       | UPDATE | {public}        | PERMISSIVE | (auth.uid() IN ( SELECT trips.user_id
   FROM trips
  WHERE (trips.trip_id = accommodations.trip_id)))                                                                                                                                                                                                                                                                                                             | (auth.uid() IN ( SELECT trips.user_id
   FROM trips
  WHERE (trips.trip_id = accommodations.trip_id)))                                                                                                                                                                                   |
| public     | accommodations      | Users can view and edit accommodations for trips shared with th | ALL    | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM trips
  WHERE ((trips.trip_id = accommodations.trip_id) AND ((trips.user_id = auth.uid()) OR (EXISTS ( SELECT 1
           FROM trip_shares
          WHERE ((trip_shares.trip_id = trips.trip_id) AND (trip_shares.shared_with_email = auth.email()))))))))                                                                                                                            | null                                                                                                                                                                                                                                                                                     |
| public     | accommodations      | Users can view their accommodations                             | SELECT | {authenticated} | PERMISSIVE | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                     |
| public     | accommodations      | Users can view their own accommodations                         | SELECT | {public}        | PERMISSIVE | (auth.uid() IN ( SELECT trips.user_id
   FROM trips
  WHERE (trips.trip_id = accommodations.trip_id)))                                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                     |
| public     | accommodations_days | Users can delete their accommodation days                       | DELETE | {authenticated} | PERMISSIVE | (stay_id IN ( SELECT accommodations.stay_id
   FROM accommodations
  WHERE (accommodations.trip_id IN ( SELECT trips.trip_id
           FROM trips
          WHERE (trips.user_id = auth.uid())))))                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                     |
| public     | accommodations_days | Users can delete their own accommodation days                   | DELETE | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM (accommodations a
     JOIN trips t ON ((t.trip_id = a.trip_id)))
  WHERE ((a.stay_id = accommodations_days.stay_id) AND (t.user_id = auth.uid()))))                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                     |
| public     | accommodations_days | Users can insert their accommodation days                       | INSERT | {authenticated} | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (stay_id IN ( SELECT accommodations.stay_id
   FROM accommodations
  WHERE (accommodations.trip_id IN ( SELECT trips.trip_id
           FROM trips
          WHERE (trips.user_id = auth.uid())))))                                                                                      |
| public     | accommodations_days | Users can insert their own accommodation days                   | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (EXISTS ( SELECT 1
   FROM (accommodations a
     JOIN trips t ON ((t.trip_id = a.trip_id)))
  WHERE ((a.stay_id = accommodations_days.stay_id) AND (t.user_id = auth.uid()))))                                                                                                          |
| public     | accommodations_days | Users can update their accommodation days                       | UPDATE | {authenticated} | PERMISSIVE | (stay_id IN ( SELECT accommodations.stay_id
   FROM accommodations
  WHERE (accommodations.trip_id IN ( SELECT trips.trip_id
           FROM trips
          WHERE (trips.user_id = auth.uid())))))                                                                                                                                                                                                                | (stay_id IN ( SELECT accommodations.stay_id
   FROM accommodations
  WHERE (accommodations.trip_id IN ( SELECT trips.trip_id
           FROM trips
          WHERE (trips.user_id = auth.uid())))))                                                                                      |
| public     | accommodations_days | Users can view their accommodation days                         | SELECT | {authenticated} | PERMISSIVE | (stay_id IN ( SELECT accommodations.stay_id
   FROM accommodations
  WHERE (accommodations.trip_id IN ( SELECT trips.trip_id
           FROM trips
          WHERE (trips.user_id = auth.uid())))))                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                     |
| public     | accommodations_days | Users can view their own accommodation days                     | SELECT | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM (accommodations a
     JOIN trips t ON ((t.trip_id = a.trip_id)))
  WHERE ((a.stay_id = accommodations_days.stay_id) AND (t.user_id = auth.uid()))))                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                     |
| public     | chat_logs           | Users can delete their own chat messages                        | DELETE | {public}        | PERMISSIVE | (user_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                     |
| public     | chat_logs           | Users can insert chat logs for accessible trips                 | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())
UNION
 SELECT trip_shares.trip_id
   FROM trip_shares
  WHERE (trip_shares.shared_by_user_id = auth.uid())))                                                                                       |
| public     | chat_logs           | Users can read chat logs for accessible trips                   | SELECT | {public}        | PERMISSIVE | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())
UNION
 SELECT trip_shares.trip_id
   FROM trip_shares
  WHERE (trip_shares.shared_by_user_id = auth.uid())))                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                                     |
| public     | chat_logs           | Users can update their own chat messages                        | UPDATE | {public}        | PERMISSIVE | (user_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                             | (user_id = auth.uid())                                                                                                                                                                                                                                                                   |
| public     | currencies          | Authenticated users can read currencies                         | SELECT | {authenticated} | PERMISSIVE | true                                                                                                                                                                                                                                                                                                                                                                                                               | null                                                                                                                                                                                                                                                                                     |
| public     | currencies          | Service role can modify currencies                              | ALL    | {service_role}  | PERMISSIVE | true                                                                                                                                                                                                                                                                                                                                                                                                               | true                                                                                                                                                                                                                                                                                     |
| public     | day_activities      | Users can delete activities with edit permission                | DELETE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | day_activities      | Users can delete their own day activities                       | DELETE | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM (trip_days
     JOIN trips ON ((trips.trip_id = trip_days.trip_id)))
  WHERE ((trip_days.day_id = day_activities.day_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                     |
| public     | day_activities      | Users can insert activities with edit permission                | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                        |
| public     | day_activities      | Users can insert their own day activities                       | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (EXISTS ( SELECT 1
   FROM (trip_days
     JOIN trips ON ((trips.trip_id = trip_days.trip_id)))
  WHERE ((trip_days.day_id = day_activities.day_id) AND (trips.user_id = auth.uid()))))                                                                                                  |
| public     | day_activities      | Users can update activities with edit permission                | UPDATE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | day_activities      | Users can update their own day activities                       | UPDATE | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM (trip_days
     JOIN trips ON ((trips.trip_id = trip_days.trip_id)))
  WHERE ((trip_days.day_id = day_activities.day_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                     |
| public     | day_activities      | Users can view activities for their trips                       | SELECT | {authenticated} | PERMISSIVE | (day_id IN ( SELECT trip_days.day_id
   FROM trip_days
  WHERE (trip_days.trip_id IN ( SELECT trips.trip_id
           FROM trips
          WHERE (trips.user_id = auth.uid())))))                                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                                     |
| public     | day_activities      | Users can view and edit day activities for trips shared with th | ALL    | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM trip_days
  WHERE ((trip_days.day_id = day_activities.day_id) AND (EXISTS ( SELECT 1
           FROM trips
          WHERE ((trips.trip_id = trip_days.trip_id) AND ((trips.user_id = auth.uid()) OR (EXISTS ( SELECT 1
                   FROM trip_shares
                  WHERE ((trip_shares.trip_id = trips.trip_id) AND (trip_shares.shared_with_email = auth.email()))))))))))) | null                                                                                                                                                                                                                                                                                     |
| public     | day_activities      | Users can view their own day activities                         | SELECT | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM (trip_days
     JOIN trips ON ((trips.trip_id = trip_days.trip_id)))
  WHERE ((trip_days.day_id = day_activities.day_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                     |
| public     | exchange_rates      | Allow anyone to read exchange rates                             | SELECT | {authenticated} | PERMISSIVE | true                                                                                                                                                                                                                                                                                                                                                                                                               | null                                                                                                                                                                                                                                                                                     |
| public     | expenses            | Users can delete expenses with edit permission                  | DELETE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | expenses            | Users can delete their own expenses                             | DELETE | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM trips
  WHERE ((trips.trip_id = expenses.trip_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                                   | null                                                                                                                                                                                                                                                                                     |
| public     | expenses            | Users can insert expenses for their own trips                   | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (EXISTS ( SELECT 1
   FROM trips
  WHERE ((trips.trip_id = expenses.trip_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                         |
| public     | expenses            | Users can insert expenses with edit permission                  | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                        |
| public     | expenses            | Users can update expenses with edit permission                  | UPDATE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | expenses            | Users can update their own expenses                             | UPDATE | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM trips
  WHERE ((trips.trip_id = expenses.trip_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                                   | (EXISTS ( SELECT 1
   FROM trips
  WHERE ((trips.trip_id = expenses.trip_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                         |
| public     | expenses            | Users can view their own expenses                               | SELECT | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM trips
  WHERE ((trips.trip_id = expenses.trip_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                                   | null                                                                                                                                                                                                                                                                                     |
| public     | other_expenses      | Users can delete other expenses with edit permission            | DELETE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | other_expenses      | Users can insert other expenses with edit permission            | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                        |
| public     | other_expenses      | Users can manage their own expenses                             | ALL    | {public}        | PERMISSIVE | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                     |
| public     | other_expenses      | Users can update other expenses with edit permission            | UPDATE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | profiles            | Allow authenticated users to update their own profiles          | UPDATE | {authenticated} | PERMISSIVE | (( SELECT auth.uid() AS uid) = id)                                                                                                                                                                                                                                                                                                                                                                                 | (( SELECT auth.uid() AS uid) = id)                                                                                                                                                                                                                                                       |
| public     | profiles            | Allow authenticated users to view their own profiles            | SELECT | {authenticated} | PERMISSIVE | (( SELECT auth.uid() AS uid) = id)                                                                                                                                                                                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                                     |
| public     | profiles            | Public profiles are viewable by everyone                        | SELECT | {public}        | PERMISSIVE | true                                                                                                                                                                                                                                                                                                                                                                                                               | null                                                                                                                                                                                                                                                                                     |
| public     | profiles            | Users can insert their own profile                              | INSERT | {authenticated} | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (auth.uid() = id)                                                                                                                                                                                                                                                                        |
| public     | profiles            | Users can update their own profile                              | UPDATE | {authenticated} | PERMISSIVE | (auth.uid() = id)                                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | reservations        | Users can access shared trip reservations                       | ALL    | {authenticated} | PERMISSIVE | ((auth.uid() IN ( SELECT trips.user_id
   FROM trips
  WHERE (trips.trip_id = reservations.trip_id))) OR (auth.email() IN ( SELECT trip_shares.shared_with_email
   FROM trip_shares
  WHERE (trip_shares.trip_id = reservations.trip_id))))                                                                                                                                                                       | ((auth.uid() IN ( SELECT trips.user_id
   FROM trips
  WHERE (trips.trip_id = reservations.trip_id))) OR (auth.email() IN ( SELECT trip_shares.shared_with_email
   FROM trip_shares
  WHERE (trip_shares.trip_id = reservations.trip_id))))                                             |
| public     | reservations        | Users can delete reservations with edit permission              | DELETE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | reservations        | Users can delete their own restaurant reservations              | DELETE | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM (trip_days
     JOIN trips ON ((trips.trip_id = trip_days.trip_id)))
  WHERE ((trip_days.day_id = reservations.day_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                                                     |
| public     | reservations        | Users can delete their restaurant reservations                  | DELETE | {authenticated} | PERMISSIVE | (day_id IN ( SELECT trip_days.day_id
   FROM trip_days
  WHERE (trip_days.trip_id IN ( SELECT trips.trip_id
           FROM trips
          WHERE (trips.user_id = auth.uid())))))                                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                                     |
| public     | reservations        | Users can insert reservations with edit permission              | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                        |
| public     | reservations        | Users can insert their own restaurant reservations              | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (EXISTS ( SELECT 1
   FROM (trip_days
     JOIN trips ON ((trips.trip_id = trip_days.trip_id)))
  WHERE ((trip_days.day_id = reservations.day_id) AND (trips.user_id = auth.uid()))))                                                                                                    |
| public     | reservations        | Users can insert their restaurant reservations                  | INSERT | {authenticated} | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (day_id IN ( SELECT trip_days.day_id
   FROM trip_days
  WHERE (trip_days.trip_id IN ( SELECT trips.trip_id
           FROM trips
          WHERE (trips.user_id = auth.uid())))))                                                                                                       |
| public     | reservations        | Users can update reservations with edit permission              | UPDATE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | reservations        | Users can update their own restaurant reservations              | UPDATE | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM (trip_days
     JOIN trips ON ((trips.trip_id = trip_days.trip_id)))
  WHERE ((trip_days.day_id = reservations.day_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                                                     |
| public     | reservations        | Users can update their restaurant reservations                  | UPDATE | {authenticated} | PERMISSIVE | (day_id IN ( SELECT trip_days.day_id
   FROM trip_days
  WHERE (trip_days.trip_id IN ( SELECT trips.trip_id
           FROM trips
          WHERE (trips.user_id = auth.uid())))))                                                                                                                                                                                                                                 | (day_id IN ( SELECT trip_days.day_id
   FROM trip_days
  WHERE (trip_days.trip_id IN ( SELECT trips.trip_id
           FROM trips
          WHERE (trips.user_id = auth.uid())))))                                                                                                       |
| public     | reservations        | Users can view their own restaurant reservations                | SELECT | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM (trip_days
     JOIN trips ON ((trips.trip_id = trip_days.trip_id)))
  WHERE ((trip_days.day_id = reservations.day_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                                                     |
| public     | reservations        | Users can view their restaurant reservations                    | SELECT | {authenticated} | PERMISSIVE | (day_id IN ( SELECT trip_days.day_id
   FROM trip_days
  WHERE (trip_days.trip_id IN ( SELECT trips.trip_id
           FROM trips
          WHERE (trips.user_id = auth.uid())))))                                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                                     |
| public     | transportation      | Users can delete their own transportation events                | DELETE | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM trips
  WHERE ((trips.trip_id = transportation.trip_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                     |
| public     | transportation      | Users can delete their transportation events                    | DELETE | {authenticated} | PERMISSIVE | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                     |
| public     | transportation      | Users can delete transportation with edit permission            | DELETE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | transportation      | Users can insert their own transportation events                | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (EXISTS ( SELECT 1
   FROM trips
  WHERE ((trips.trip_id = transportation.trip_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                   |
| public     | transportation      | Users can insert their transportation events                    | INSERT | {authenticated} | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                  |
| public     | transportation      | Users can insert transportation with edit permission            | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                        |
| public     | transportation      | Users can update their own transportation events                | UPDATE | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM trips
  WHERE ((trips.trip_id = transportation.trip_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                     |
| public     | transportation      | Users can update their transportation events                    | UPDATE | {authenticated} | PERMISSIVE | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                            | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                  |
| public     | transportation      | Users can update transportation with edit permission            | UPDATE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | transportation      | Users can view and edit transportation for trips shared with th | ALL    | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM trips
  WHERE ((trips.trip_id = transportation.trip_id) AND ((trips.user_id = auth.uid()) OR (EXISTS ( SELECT 1
           FROM trip_shares
          WHERE ((trip_shares.trip_id = trips.trip_id) AND (trip_shares.shared_with_email = auth.email()))))))))                                                                                                                            | null                                                                                                                                                                                                                                                                                     |
| public     | transportation      | Users can view their own transportation events                  | SELECT | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM trips
  WHERE ((trips.trip_id = transportation.trip_id) AND (trips.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                     |
| public     | transportation      | Users can view their transportation events                      | SELECT | {authenticated} | PERMISSIVE | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                     |
| public     | trip_days           | Users can delete their own trip days                            | DELETE | {authenticated} | PERMISSIVE | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                     |
| public     | trip_days           | Users can delete trip days with edit permission                 | DELETE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | trip_days           | Users can insert their own trip days                            | INSERT | {authenticated} | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                  |
| public     | trip_days           | Users can insert trip days with edit permission                 | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                        |
| public     | trip_days           | Users can update their own trip days                            | UPDATE | {authenticated} | PERMISSIVE | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                            | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                  |
| public     | trip_days           | Users can update trip days with edit permission                 | UPDATE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | trip_days           | Users can view and edit trip days for trips shared with them    | ALL    | {public}        | PERMISSIVE | (EXISTS ( SELECT 1
   FROM trips
  WHERE ((trips.trip_id = trip_days.trip_id) AND ((trips.user_id = auth.uid()) OR (EXISTS ( SELECT 1
           FROM trip_shares
          WHERE ((trip_shares.trip_id = trips.trip_id) AND (trip_shares.shared_with_email = auth.email()))))))))                                                                                                                                 | null                                                                                                                                                                                                                                                                                     |
| public     | trip_days           | Users can view their own trip days                              | SELECT | {authenticated} | PERMISSIVE | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                     |
| public     | trip_shares         | Trip owners can share trips                                     | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | ((EXISTS ( SELECT 1
   FROM trips
  WHERE ((trips.trip_id = trips.trip_id) AND (trips.user_id = auth.uid())))) OR (EXISTS ( SELECT 1
   FROM trip_shares trip_shares_1
  WHERE ((trip_shares_1.trip_id = trip_shares_1.trip_id) AND (trip_shares_1.shared_with_email = auth.email()))))) |
| public     | trip_shares         | Trips shared with user are viewable                             | SELECT | {public}        | PERMISSIVE | ((auth.uid() = shared_by_user_id) OR (auth.email() = shared_with_email))                                                                                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                                                     |
| public     | trip_shares         | Users can delete shares they created                            | DELETE | {public}        | PERMISSIVE | ((auth.uid() = shared_by_user_id) OR (EXISTS ( SELECT 1
   FROM trips
  WHERE ((trips.trip_id = trips.trip_id) AND (trips.user_id = auth.uid())))))                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                     |
| public     | trips               | Enable insert for authenticated users                           | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (auth.uid() = user_id)                                                                                                                                                                                                                                                                   |
| public     | trips               | Users can create their own trips                                | INSERT | {authenticated} | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (auth.uid() = user_id)                                                                                                                                                                                                                                                                   |
| public     | trips               | Users can delete their own trips                                | DELETE | {authenticated} | PERMISSIVE | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                     |
| public     | trips               | Users can update trips with edit permission                     | UPDATE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | trips               | Users can view and edit trips shared with them                  | ALL    | {public}        | PERMISSIVE | ((user_id = auth.uid()) OR (EXISTS ( SELECT 1
   FROM trip_shares
  WHERE ((trip_shares.trip_id = trip_shares.trip_id) AND (trip_shares.shared_with_email = auth.email())))))                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                     |
| public     | trips               | Users can view their own trips                                  | SELECT | {authenticated} | PERMISSIVE | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                     |
| public     | vision_board_items  | Users can delete their own vision board items                   | DELETE | {public}        | PERMISSIVE | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                     |
| public     | vision_board_items  | Users can delete vision board items with edit permission        | DELETE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | vision_board_items  | Users can insert their own vision board items                   | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                  |
| public     | vision_board_items  | Users can insert vision board items with edit permission        | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                        |
| public     | vision_board_items  | Users can update their own vision board items                   | UPDATE | {public}        | PERMISSIVE | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                            | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                  |
| public     | vision_board_items  | Users can update vision board items with edit permission        | UPDATE | {public}        | PERMISSIVE | user_has_edit_permission(trip_id)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| public     | vision_board_items  | Users can view their own vision board items                     | SELECT | {public}        | PERMISSIVE | (trip_id IN ( SELECT trips.trip_id
   FROM trips
  WHERE (trips.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                     |
| storage    | objects             | Allow authenticated users to upload images                      | INSERT | {authenticated} | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | (bucket_id = 'trip-images'::text)                                                                                                                                                                                                                                                        |
| storage    | objects             | Allow public read access                                        | SELECT | {public}        | PERMISSIVE | (bucket_id = 'trip-images'::text)                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| storage    | objects             | Allow users to delete their own images                          | DELETE | {authenticated} | PERMISSIVE | ((bucket_id = 'trip-images'::text) AND (auth.uid() = owner))                                                                                                                                                                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                                     |
| storage    | objects             | Allow users to update their own images                          | UPDATE | {authenticated} | PERMISSIVE | ((bucket_id = 'trip-images'::text) AND (auth.uid() = owner))                                                                                                                                                                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                                     |
| storage    | objects             | chat_attachments_delete_policy                                  | DELETE | {public}        | PERMISSIVE | ((bucket_id = 'chat-attachments'::text) AND ((auth.uid())::text = (storage.foldername(name))[1]))                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| storage    | objects             | chat_attachments_select_policy                                  | SELECT | {public}        | PERMISSIVE | ((bucket_id = 'chat-attachments'::text) AND ((auth.uid())::text = (storage.foldername(name))[1]))                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| storage    | objects             | chat_attachments_update_policy                                  | UPDATE | {public}        | PERMISSIVE | ((bucket_id = 'chat-attachments'::text) AND ((auth.uid())::text = (storage.foldername(name))[1]))                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                     |
| storage    | objects             | chat_attachments_upload_policy                                  | INSERT | {public}        | PERMISSIVE | null                                                                                                                                                                                                                                                                                                                                                                                                               | ((bucket_id = 'chat-attachments'::text) AND ((auth.uid())::text = (storage.foldername(name))[1]))                                                                                                                                                                                        |